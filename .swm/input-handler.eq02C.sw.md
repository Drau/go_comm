---
id: eq02C
name: Input handler
file_version: 1.0.2
app_version: 0.6.5-2
file_blobs:
  main.go: 0000ef6ee9e8211e3571ccd6219409346da880af
---

The Input handler `dealWithInput`[<sup id="Z13ly9t">â†“</sup>](#f-Z13ly9t) receives all text from Input box , and sends its to all other chat participants / analyzes the requested commands and acts accordingly.

Every regular message received gets sent to all existing connections `conn.sendMessage`[<sup id="13kzca">â†“</sup>](#f-13kzca)

Special commands are:

1.  \\help command opens the hep menu with all possible commands
    
2.  \\quit command exists the app
    
3.  etc...

<br/>

<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ğŸ“„ main.go
```go
â¬œ 175    }
â¬œ 176    
â¬œ 177    // function to deal with all user inputs
ğŸŸ© 178    func dealWithInput(app *tview.Application,
ğŸŸ© 179    	logs *tview.TextView,
ğŸŸ© 180    	chat *tview.TextView,
ğŸŸ© 181    	input *tview.InputField,
ğŸŸ© 182    	pages *tview.Pages,
ğŸŸ© 183    	help *tview.Modal,
ğŸŸ© 184    	connectPage *tview.Form,
ğŸŸ© 185    	conns connections) {
ğŸŸ© 186    	text := input.GetText()
ğŸŸ© 187    	if text == "" {
ğŸŸ© 188    		return
ğŸŸ© 189    	}
ğŸŸ© 190    	switch strings.ToLower(text) {
ğŸŸ© 191    	case "\\help", "\\h":
ğŸŸ© 192    		pages.ShowPage("Help")
ğŸŸ© 193    		app.SetFocus(help)
ğŸŸ© 194    	case "\\quit", "\\q":
ğŸŸ© 195    		app.Stop()
ğŸŸ© 196    	case "\\connect", "\\c":
ğŸŸ© 197    		pages.ShowPage("Connect")
ğŸŸ© 198    		app.SetFocus(connectPage)
ğŸŸ© 199    	case "\\ac":
ğŸŸ© 200    		fmt.Fprintf(logs, "Active connections:\n--------------\n")
ğŸŸ© 201    		for _, c := range conns {
ğŸŸ© 202    			fmt.Fprintf(logs, "%v\n", *c)
ğŸŸ© 203    		}
ğŸŸ© 204    		fmt.Fprintf(logs, "--------------\n")
ğŸŸ© 205    	default:
ğŸŸ© 206    		splitText := strings.SplitN(text, " ", 3)
ğŸŸ© 207    		switch strings.ToLower(splitText[0]) {
ğŸŸ© 208    		case "\\pm":
ğŸŸ© 209    			if len(splitText) < 3 {
ğŸŸ© 210    				fmt.Fprintf(logs, "Cant send pm. user / message are missing\n")
ğŸŸ© 211    				break
ğŸŸ© 212    			}
ğŸŸ© 213    			userName := splitText[1]
ğŸŸ© 214    			text := splitText[2]
ğŸŸ© 215    			conn := conns[userName]
ğŸŸ© 216    			if conn == nil {
ğŸŸ© 217    				fmt.Fprintf(logs, "No such user <%s> to PM\n", userName)
ğŸŸ© 218    				break
ğŸŸ© 219    			}
ğŸŸ© 220    			err := conn.sendMessage("PM@" + text)
ğŸŸ© 221    			if err != nil {
ğŸŸ© 222    				fmt.Fprintf(logs, "Failed to send message to %s: %s\n", userName, err)
ğŸŸ© 223    			} else {
ğŸŸ© 224    				fmt.Fprintf(chat, "[PM->%s]%s >> %s\n", userName, conns["local"].name, text)
ğŸŸ© 225    				fmt.Fprintf(logs, "Sending pm to %s\n", userName)
ğŸŸ© 226    
ğŸŸ© 227    			}
ğŸŸ© 228    		case "\\dc":
ğŸŸ© 229    			if len(splitText) != 2 {
ğŸŸ© 230    				fmt.Fprintf(logs, "Cant disconnect user. \n")
ğŸŸ© 231    				break
ğŸŸ© 232    			}
ğŸŸ© 233    			r := conns[splitText[1]]
ğŸŸ© 234    			if r == nil {
ğŸŸ© 235    				fmt.Fprintf(logs, "No such user %s", splitText[1])
ğŸŸ© 236    				return
ğŸŸ© 237    			}
ğŸŸ© 238    			disconnectClient(conns, r, logs)
ğŸŸ© 239    		default:
ğŸŸ© 240    			fmt.Fprintf(logs, "Sending broadcast\n")
ğŸŸ© 241    			// send text to all connected users
ğŸŸ© 242    			for name, conn := range conns {
ğŸŸ© 243    				if name == "local" {
ğŸŸ© 244    					continue
ğŸŸ© 245    				}
ğŸŸ© 246    				fmt.Fprintf(logs, "Sending message to %s- %s\n", name, conn.getAddress())
ğŸŸ© 247    				err := conn.sendMessage(text)
ğŸŸ© 248    				if err != nil {
ğŸŸ© 249    					fmt.Fprintf(logs, "Failed to send message to %s: %s\n", name, err)
ğŸŸ© 250    					continue
ğŸŸ© 251    				}
ğŸŸ© 252    			}
ğŸŸ© 253    			fmt.Fprintf(chat, "%s >> %s\n", conns["local"].name, text)
ğŸŸ© 254    		}
ğŸŸ© 255    	}
ğŸŸ© 256    }
â¬œ 257    
```

<br/>

<!-- THIS IS AN AUTOGENERATED SECTION. DO NOT EDIT THIS SECTION DIRECTLY -->
### Swimm Note

<span id="f-13kzca">conn.sendMessage</span>[^](#13kzca) - "main.go" L247
```go
				err := conn.sendMessage(text)
```

<span id="f-Z13ly9t">dealWithInput</span>[^](#Z13ly9t) - "main.go" L178
```go
func dealWithInput(app *tview.Application,
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBZ29fY29tbSUzQSUzQURyYXU=/docs/eq02C).